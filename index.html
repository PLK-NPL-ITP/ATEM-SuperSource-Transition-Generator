<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuperSource Transition Generator</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container"></div>

    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <rect x="2" y="2" width="12" height="12" rx="2" fill="#FF4757"/>
                        <rect x="18" y="2" width="12" height="12" rx="2" fill="#FF6B7A"/>
                        <rect x="2" y="18" width="12" height="12" rx="2" fill="#FF6B7A"/>
                        <rect x="18" y="18" width="12" height="12" rx="2" fill="#FF4757"/>
                    </svg>
                    <h1 data-i18n="header.title">SuperSource Transition</h1>
                </div>
                <p class="subtitle" data-i18n="header.subtitle">ATEM SuperSource Transition XML Generator</p>
            </div>
            <div class="header-controls">
                <button class="icon-btn" id="themeToggle" title="Toggle Theme">
                    <svg class="theme-icon theme-icon-light" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"/>
                        <line x1="12" y1="1" x2="12" y2="3"/>
                        <line x1="12" y1="21" x2="12" y2="23"/>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                        <line x1="1" y1="12" x2="3" y2="12"/>
                        <line x1="21" y1="12" x2="23" y2="12"/>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                    </svg>
                    <svg class="theme-icon theme-icon-dark" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                    </svg>
                </button>
                <button class="icon-btn" id="languageToggle" title="Toggle Language">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="2" y1="12" x2="22" y2="12"/>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                    </svg>
                    <span class="language-label">EN</span>
                </button>
            </div>
        </header>

        <!-- Preview Section -->
        <section class="preview-section">
            <div class="preview-header">
                <h2 data-i18n="preview.title">Position Preview</h2>
                <div class="preview-header-controls">
                    <div class="precision-toggle" id="dragPrecisionToggle">
                        <span class="precision-label" data-i18n="preview.dragPrecision">Drag Precision</span>
                        <button class="precision-btn" data-precision="precise" data-i18n-title="preview.precisionPrecise" title="Precise">Precise</button>
                        <button class="precision-btn active" data-precision="medium" data-i18n-title="preview.precisionMedium" title="Medium">Medium</button>
                        <button class="precision-btn" data-precision="coarse" data-i18n-title="preview.precisionCoarse" title="Coarse">Coarse</button>
                    </div>
                    <div class="preview-toggle">
                        <button class="toggle-btn active" data-view="initial" data-i18n="preview.initialPosition">Initial Position</button>
                        <button class="toggle-btn indicator" data-view="transforming" disabled data-i18n="preview.transforming">Transforming</button>
                        <button class="toggle-btn" data-view="final" data-i18n="preview.finalPosition">Final Position</button>
                    </div>
                </div>
            </div>
            <div class="preview-canvas-container">
                <canvas id="previewCanvas"></canvas>
                <div class="canvas-info">
                    <span class="info-label" data-i18n="preview.visibleArea">Visible Area: X [-16, 16] | Y [-9, 9] (16:9)</span>
                </div>
            </div>
            <!-- Preview Controls -->
            <div class="preview-controls" id="previewControls" style="display: none;">
                <div class="controls-row">
                    <button class="control-btn" id="prevFrameBtn" data-i18n-title="preview.prevFrame" title="Previous Frame">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="19 20 9 12 19 4 19 20"/>
                            <line x1="5" y1="19" x2="5" y2="5"/>
                        </svg>
                    </button>
                    <button class="control-btn" id="playPauseBtn" data-i18n-title="preview.playPause" title="Play/Pause">
                        <svg class="play-icon" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <polygon points="5 3 19 12 5 21 5 3"/>
                        </svg>
                        <svg class="pause-icon" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
                            <rect x="6" y="4" width="4" height="16"/>
                            <rect x="14" y="4" width="4" height="16"/>
                        </svg>
                    </button>
                    <button class="control-btn" id="nextFrameBtn" data-i18n-title="preview.nextFrame" title="Next Frame">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="5 4 15 12 5 20 5 4"/>
                            <line x1="19" y1="5" x2="19" y2="19"/>
                        </svg>
                    </button>
                </div>
                <div class="progress-row">
                    <span class="frame-label" id="currentFrameLabel">0</span>
                    <input type="range" class="progress-slider" id="frameSlider" min="0" max="100" value="0">
                    <span class="frame-label" id="totalFrameLabel">0</span>
                </div>
            </div>
            <div class="box-legend">
                <div class="legend-item" data-box="0"><span class="legend-color box0"></span>Box 0</div>
                <div class="legend-item" data-box="1"><span class="legend-color box1"></span>Box 1</div>
                <div class="legend-item" data-box="2"><span class="legend-color box2"></span>Box 2</div>
                <div class="legend-item" data-box="3"><span class="legend-color box3"></span>Box 3</div>
            </div>
        </section>

        <!-- Box Control Panels -->
        <section class="box-controls-section">
            <div class="section-header">
                <h2 data-i18n="boxControl.title">Box Parameter Control</h2>
                <div class="section-header-actions">
                    <button class="btn btn-secondary btn-sm" id="loadSampleBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14 2 14 8 20 8"/>
                            <line x1="16" y1="13" x2="8" y2="13"/>
                            <line x1="16" y1="17" x2="8" y2="17"/>
                            <polyline points="10 9 9 9 8 9"/>
                        </svg>
                        <span data-i18n="boxControl.loadSample">Load Sample</span>
                    </button>
                    <div class="precision-toggle" id="boxCtrlPrecisionToggle">
                        <span class="precision-label" data-i18n="boxControl.dragPrecision">Drag Precision</span>
                        <button class="precision-btn" data-precision="precise" data-i18n-title="toast.precisionPrecise">Precise</button>
                        <button class="precision-btn active" data-precision="medium" data-i18n-title="toast.precisionMedium">Medium</button>
                        <button class="precision-btn" data-precision="coarse" data-i18n-title="toast.precisionCoarse">Coarse</button>
                    </div>
                    <div class="box-control-toggle">
                        <button class="toggle-btn active" data-view="initial" id="boxCtrlInitialBtn">Initial Position</button>
                        <button class="toggle-btn indicator" data-view="transforming" id="boxCtrlTransformingBtn" disabled>Transforming</button>
                        <button class="toggle-btn" data-view="final" id="boxCtrlFinalBtn">Final Position</button>
                    </div>
                </div>
            </div>
            <div class="box-controls-grid" id="boxControlsGrid">
                <!-- Box 0 -->
                <div class="box-control-panel" data-box="0">
                    <div class="box-panel-header">
                        <span class="box-color-dot box0"></span>
                        <span class="box-title">Box 0</span>
                        <button class="copy-box-btn" data-box="0" ><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        <button class="reset-box-btn" data-box="0" ><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button>
                        <label class="enable-switch">
                            <input type="checkbox" class="box-enable" data-box="0">
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                    <div class="box-panel-body">
                        <div class="param-row">
                            <label>Size</label>
                            <input type="range" class="box-slider" data-box="0" data-param="size" min="0" max="2" step="0.01" value="1">
                            <input type="number" class="box-input" data-box="0" data-param="size" step="0.01" value="1">
                            <button class="copy-param-btn" data-box="0" data-param="size" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="param-row">
                            <label>X Pos</label>
                            <input type="range" class="box-slider" data-box="0" data-param="xPosition" min="-32" max="32" step="0.01" value="0">
                            <input type="number" class="box-input" data-box="0" data-param="xPosition" step="0.01" value="0">
                            <button class="copy-param-btn" data-box="0" data-param="xPosition" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="param-row">
                            <label>Y Pos</label>
                            <input type="range" class="box-slider" data-box="0" data-param="yPosition" min="-18" max="18" step="0.01" value="0">
                            <input type="number" class="box-input" data-box="0" data-param="yPosition" step="0.01" value="0">
                            <button class="copy-param-btn" data-box="0" data-param="yPosition" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="mask-section">
                            <div class="mask-header">
                                <span>Mask/Crop</span>
                                <label class="enable-switch small">
                                    <input type="checkbox" class="mask-enable" data-box="0">
                                    <span class="switch-slider"></span>
                                </label>
                            </div>
                            <div class="mask-controls">
                                <div class="param-row with-link">
                                    <label>Left</label>
                                    <input type="range" class="box-slider" data-box="0" data-param="maskLeft" min="0" max="32" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="0" data-param="maskLeft" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="0" data-param="maskLeft" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                    <button class="link-btn" data-box="0" data-link="lr" >
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="param-row">
                                    <label>Right</label>
                                    <input type="range" class="box-slider" data-box="0" data-param="maskRight" min="0" max="32" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="0" data-param="maskRight" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="0" data-param="maskRight" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                </div>
                                <div class="param-row with-link">
                                    <label>Top</label>
                                    <input type="range" class="box-slider" data-box="0" data-param="maskTop" min="0" max="18" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="0" data-param="maskTop" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="0" data-param="maskTop" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                    <button class="link-btn" data-box="0" data-link="tb" >
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="param-row">
                                    <label>Bottom</label>
                                    <input type="range" class="box-slider" data-box="0" data-param="maskBottom" min="0" max="18" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="0" data-param="maskBottom" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="0" data-param="maskBottom" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Box 1 -->
                <div class="box-control-panel" data-box="1">
                    <div class="box-panel-header">
                        <span class="box-color-dot box1"></span>
                        <span class="box-title">Box 1</span>
                        <button class="copy-box-btn" data-box="1" ><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        <button class="reset-box-btn" data-box="1" ><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button>
                        <label class="enable-switch">
                            <input type="checkbox" class="box-enable" data-box="1">
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                    <div class="box-panel-body">
                        <div class="param-row">
                            <label>Size</label>
                            <input type="range" class="box-slider" data-box="1" data-param="size" min="0" max="2" step="0.01" value="1">
                            <input type="number" class="box-input" data-box="1" data-param="size" step="0.01" value="1">
                            <button class="copy-param-btn" data-box="1" data-param="size" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="param-row">
                            <label>X Pos</label>
                            <input type="range" class="box-slider" data-box="1" data-param="xPosition" min="-32" max="32" step="0.01" value="0">
                            <input type="number" class="box-input" data-box="1" data-param="xPosition" step="0.01" value="0">
                            <button class="copy-param-btn" data-box="1" data-param="xPosition" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="param-row">
                            <label>Y Pos</label>
                            <input type="range" class="box-slider" data-box="1" data-param="yPosition" min="-18" max="18" step="0.01" value="0">
                            <input type="number" class="box-input" data-box="1" data-param="yPosition" step="0.01" value="0">
                            <button class="copy-param-btn" data-box="1" data-param="yPosition" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="mask-section">
                            <div class="mask-header">
                                <span>Mask/Crop</span>
                                <label class="enable-switch small">
                                    <input type="checkbox" class="mask-enable" data-box="1">
                                    <span class="switch-slider"></span>
                                </label>
                            </div>
                            <div class="mask-controls">
                                <div class="param-row with-link">
                                    <label>Left</label>
                                    <input type="range" class="box-slider" data-box="1" data-param="maskLeft" min="0" max="32" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="1" data-param="maskLeft" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="1" data-param="maskLeft" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                    <button class="link-btn" data-box="1" data-link="lr" >
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="param-row">
                                    <label>Right</label>
                                    <input type="range" class="box-slider" data-box="1" data-param="maskRight" min="0" max="32" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="1" data-param="maskRight" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="1" data-param="maskRight" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                </div>
                                <div class="param-row with-link">
                                    <label>Top</label>
                                    <input type="range" class="box-slider" data-box="1" data-param="maskTop" min="0" max="18" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="1" data-param="maskTop" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="1" data-param="maskTop" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                    <button class="link-btn" data-box="1" data-link="tb" >
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="param-row">
                                    <label>Bottom</label>
                                    <input type="range" class="box-slider" data-box="1" data-param="maskBottom" min="0" max="18" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="1" data-param="maskBottom" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="1" data-param="maskBottom" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Box 2 -->
                <div class="box-control-panel" data-box="2">
                    <div class="box-panel-header">
                        <span class="box-color-dot box2"></span>
                        <span class="box-title">Box 2</span>
                        <button class="copy-box-btn" data-box="2" ><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        <button class="reset-box-btn" data-box="2" ><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button>
                        <label class="enable-switch">
                            <input type="checkbox" class="box-enable" data-box="2">
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                    <div class="box-panel-body">
                        <div class="param-row">
                            <label>Size</label>
                            <input type="range" class="box-slider" data-box="2" data-param="size" min="0" max="2" step="0.01" value="1">
                            <input type="number" class="box-input" data-box="2" data-param="size" step="0.01" value="1">
                            <button class="copy-param-btn" data-box="2" data-param="size" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="param-row">
                            <label>X Pos</label>
                            <input type="range" class="box-slider" data-box="2" data-param="xPosition" min="-32" max="32" step="0.01" value="0">
                            <input type="number" class="box-input" data-box="2" data-param="xPosition" step="0.01" value="0">
                            <button class="copy-param-btn" data-box="2" data-param="xPosition" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="param-row">
                            <label>Y Pos</label>
                            <input type="range" class="box-slider" data-box="2" data-param="yPosition" min="-18" max="18" step="0.01" value="0">
                            <input type="number" class="box-input" data-box="2" data-param="yPosition" step="0.01" value="0">
                            <button class="copy-param-btn" data-box="2" data-param="yPosition" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="mask-section">
                            <div class="mask-header">
                                <span>Mask/Crop</span>
                                <label class="enable-switch small">
                                    <input type="checkbox" class="mask-enable" data-box="2">
                                    <span class="switch-slider"></span>
                                </label>
                            </div>
                            <div class="mask-controls">
                                <div class="param-row with-link">
                                    <label>Left</label>
                                    <input type="range" class="box-slider" data-box="2" data-param="maskLeft" min="0" max="32" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="2" data-param="maskLeft" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="2" data-param="maskLeft" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                    <button class="link-btn" data-box="2" data-link="lr" >
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="param-row">
                                    <label>Right</label>
                                    <input type="range" class="box-slider" data-box="2" data-param="maskRight" min="0" max="32" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="2" data-param="maskRight" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="2" data-param="maskRight" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                </div>
                                <div class="param-row with-link">
                                    <label>Top</label>
                                    <input type="range" class="box-slider" data-box="2" data-param="maskTop" min="0" max="18" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="2" data-param="maskTop" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="2" data-param="maskTop" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                    <button class="link-btn" data-box="2" data-link="tb" >
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="param-row">
                                    <label>Bottom</label>
                                    <input type="range" class="box-slider" data-box="2" data-param="maskBottom" min="0" max="18" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="2" data-param="maskBottom" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="2" data-param="maskBottom" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Box 3 -->
                <div class="box-control-panel" data-box="3">
                    <div class="box-panel-header">
                        <span class="box-color-dot box3"></span>
                        <span class="box-title">Box 3</span>
                        <button class="copy-box-btn" data-box="3" ><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        <button class="reset-box-btn" data-box="3" ><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button>
                        <label class="enable-switch">
                            <input type="checkbox" class="box-enable" data-box="3">
                            <span class="switch-slider"></span>
                        </label>
                    </div>
                    <div class="box-panel-body">
                        <div class="param-row">
                            <label>Size</label>
                            <input type="range" class="box-slider" data-box="3" data-param="size" min="0" max="2" step="0.01" value="1">
                            <input type="number" class="box-input" data-box="3" data-param="size" step="0.01" value="1">
                            <button class="copy-param-btn" data-box="3" data-param="size" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="param-row">
                            <label>X Pos</label>
                            <input type="range" class="box-slider" data-box="3" data-param="xPosition" min="-32" max="32" step="0.01" value="0">
                            <input type="number" class="box-input" data-box="3" data-param="xPosition" step="0.01" value="0">
                            <button class="copy-param-btn" data-box="3" data-param="xPosition" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="param-row">
                            <label>Y Pos</label>
                            <input type="range" class="box-slider" data-box="3" data-param="yPosition" min="-18" max="18" step="0.01" value="0">
                            <input type="number" class="box-input" data-box="3" data-param="yPosition" step="0.01" value="0">
                            <button class="copy-param-btn" data-box="3" data-param="yPosition" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                        </div>
                        <div class="mask-section">
                            <div class="mask-header">
                                <span>Mask/Crop</span>
                                <label class="enable-switch small">
                                    <input type="checkbox" class="mask-enable" data-box="3">
                                    <span class="switch-slider"></span>
                                </label>
                            </div>
                            <div class="mask-controls">
                                <div class="param-row with-link">
                                    <label>Left</label>
                                    <input type="range" class="box-slider" data-box="3" data-param="maskLeft" min="0" max="32" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="3" data-param="maskLeft" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="3" data-param="maskLeft" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                    <button class="link-btn" data-box="3" data-link="lr" >
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="param-row">
                                    <label>Right</label>
                                    <input type="range" class="box-slider" data-box="3" data-param="maskRight" min="0" max="32" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="3" data-param="maskRight" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="3" data-param="maskRight" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                </div>
                                <div class="param-row with-link">
                                    <label>Top</label>
                                    <input type="range" class="box-slider" data-box="3" data-param="maskTop" min="0" max="18" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="3" data-param="maskTop" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="3" data-param="maskTop" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                    <button class="link-btn" data-box="3" data-link="tb" >
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="param-row">
                                    <label>Bottom</label>
                                    <input type="range" class="box-slider" data-box="3" data-param="maskBottom" min="0" max="18" step="0.1" value="0">
                                    <input type="number" class="box-input" data-box="3" data-param="maskBottom" step="0.1" value="0">
                                    <button class="copy-param-btn" data-box="3" data-param="maskBottom" ><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Parameters Section -->
        <section class="params-section">
            <div class="params-grid-2x2">
                <div class="param-group">
                    <label for="framesInput" data-i18n="params.frames">Transition Frames</label>
                    <input type="number" id="framesInput" value="30" min="1" max="300">
                </div>
                <div class="param-group">
                    <label for="fpsInput" data-i18n="params.fps">Frames Per Second (FPS)</label>
                    <input type="number" id="fpsInput" value="60" min="1" max="120">
                </div>
                <div class="param-group">
                    <label for="easingCategory" data-i18n="params.easingCategory">Easing Category</label>
                    <select id="easingCategory">
                        <option value="basic">Basic</option>
                        <option value="quadratic">Quadratic</option>
                        <option value="cubic">Cubic</option>
                        <option value="quartic">Quartic</option>
                        <option value="quintic">Quintic</option>
                        <option value="sine">Sine</option>
                        <option value="exponential">Exponential</option>
                        <option value="circular">Circular</option>
                        <option value="back">Back</option>
                        <option value="elastic">Elastic</option>
                        <option value="bounce">Bounce</option>
                    </select>
                </div>
                <div class="param-group">
                    <label for="easingType" data-i18n="params.easingType">Easing Curve</label>
                    <select id="easingType">
                        <option value="linear">linear</option>
                        <option value="ease_in">ease_in</option>
                        <option value="ease_out">ease_out</option>
                        <option value="ease_in_out">ease_in_out</option>
                    </select>
                </div>
            </div>
            <div class="easing-preview-container">
                <label data-i18n="params.curvePreview">Curve Preview</label>
                <canvas id="easingPreviewCanvas"></canvas>
            </div>
        </section>

        <!-- Input/Output Section -->
        <section class="io-section">
            <div class="io-grid">
                <!-- Initial Position -->
                <div class="io-panel">
                    <div class="panel-header">
                        <h3>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                            <span data-i18n="io.initialXml">Initial Position XML</span>
                        </h3>
                        <div class="panel-actions">
                            <button class="btn btn-icon" id="copyInitialBtn" data-i18n-title="io.copy">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                                </svg>
                            </button>
                            <button class="btn btn-icon" id="saveInitialBtn" data-i18n-title="io.save">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="7 10 12 15 17 10"/>
                                    <line x1="12" y1="15" x2="12" y2="3"/>
                                </svg>
                            </button>
                            <button class="btn btn-icon" id="clearInitialBtn" data-i18n-title="io.clear">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="3 6 5 6 21 6"/>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                                </svg>
                            </button>
                            <button class="btn btn-icon" id="formatInitialBtn" data-i18n-title="io.format">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="21" y1="10" x2="3" y2="10"/>
                                    <line x1="21" y1="6" x2="3" y2="6"/>
                                    <line x1="21" y1="14" x2="3" y2="14"/>
                                    <line x1="21" y1="18" x2="3" y2="18"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <textarea id="initialXml" data-i18n-placeholder="io.initialPlaceholder" placeholder="Paste initial position SuperSource XML..."></textarea>
                </div>

                <!-- Swap Button -->
                <div class="swap-container">
                    <button class="btn btn-swap" id="swapBtn" data-i18n-title="io.swap">
                        <!-- Horizontal arrows (wide screen) -->
                        <svg class="swap-icon-h" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M4 7h16M4 7l4-4M4 7l4 4"/>
                            <path d="M20 17H4M20 17l-4-4M20 17l-4 4"/>
                        </svg>
                        <!-- Vertical arrows (narrow screen) -->
                        <svg class="swap-icon-v" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M7 4v16M7 4L3 8M7 4l4 4"/>
                            <path d="M17 20V4M17 20l-4-4M17 20l4-4"/>
                        </svg>
                    </button>
                </div>

                <!-- Final Position -->
                <div class="io-panel">
                    <div class="panel-header">
                        <h3>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22 4 12 14.01 9 11.01"/>
                            </svg>
                            <span data-i18n="io.finalXml">Final Position XML</span>
                        </h3>
                        <div class="panel-actions">
                            <button class="btn btn-icon" id="copyFinalBtn" data-i18n-title="io.copy">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                                </svg>
                            </button>
                            <button class="btn btn-icon" id="saveFinalBtn" data-i18n-title="io.save">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="7 10 12 15 17 10"/>
                                    <line x1="12" y1="15" x2="12" y2="3"/>
                                </svg>
                            </button>
                            <button class="btn btn-icon" id="clearFinalBtn" data-i18n-title="io.clear">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="3 6 5 6 21 6"/>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                                </svg>
                            </button>
                            <button class="btn btn-icon" id="formatFinalBtn" data-i18n-title="io.format">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="21" y1="10" x2="3" y2="10"/>
                                    <line x1="21" y1="6" x2="3" y2="6"/>
                                    <line x1="21" y1="14" x2="3" y2="14"/>
                                    <line x1="21" y1="18" x2="3" y2="18"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <textarea id="finalXml" data-i18n-placeholder="io.finalPlaceholder" placeholder="Paste final position SuperSource XML..."></textarea>
                </div>
            </div>
        </section>

        <!-- Output Section -->
        <section class="output-section">
            <div class="output-header">
                <h3>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="4 17 10 11 4 5"/>
                        <line x1="12" y1="19" x2="20" y2="19"/>
                    </svg>
                    <span data-i18n="output.title">Output Preview</span>
                </h3>
                <div class="output-actions">
                    <span class="output-info" id="outputInfo"></span>
                    <button class="btn btn-icon" id="copyOutputBtn" data-i18n-title="io.copy" title="Copy">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                        </svg>
                    </button>
                    <button class="btn btn-icon" id="saveOutputBtn" data-i18n-title="io.save" title="Save">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="output-container">
                <pre id="outputXml"><code data-i18n="output.placeholder"><!-- Generated XML will be displayed here --></code></pre>
            </div>
        </section>

        <!-- Footer -->
        <footer class="app-footer">
            <p>SuperSource Transition Generator | NPL ITP Infrastructure (Development) Group</p>
            <p class="copyright"> 2025 Jason Yang Jiepeng. All rights reserved.</p>
        </footer>
    </div>

    <script src="i18n.js"></script>
    <script src="toastMessage.js"></script>
    <script src="app.js"></script>
</body>
</html>
